<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
	</head>
	<body>
		<video controls id="video"></video>
		<script>
			const video = document.getElementById("video");

				const mediaSource = new MediaSource();
				video.src = URL.createObjectURL(mediaSource);
			const fetchNext = () => {
				mediaSource.addEventListener("sourceopen", () => {
					const sourceBuffer = mediaSource.addSourceBuffer("video/mp4");
					sourceBuffer.mode = 'sequence';

					fetch("http://localhost:8080")
						.then(response => response.arrayBuffer())
						.then(data => {
							sourceBuffer.appendBuffer(data);
						});
					sourceBuffer.addEventListener("updateend", () => {
						mediaSource.endOfStream();
						video.play();
					});

				});
			}

			fetchNext()
			video.addEventListener("ended", () => {
				fetchNext()
				video.play()
			})

		</script>
	</body>
</html>
